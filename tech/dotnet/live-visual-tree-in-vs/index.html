<!doctype html><html><head><title>Amadeus' page</title><link rel=stylesheet href=//amadeusw.com/css/style.css><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Personal website of Amadeusz Wieczorek about projects, travel and programming."></head><body><header id=title><a href=//amadeusw.com><h2>Amadeusz Wieczorek</h2></a></header><main><article class=tech><header id=postheader class=accent_tech><h3>Using Live Visual Tree to discover internals of Visual Studio</h3></header><p>Visual Studio 2015 brings many new debugging and productivity tools. My favorites are <a href=http://blogs.msdn.com/b/visualstudioalm/archive/2015/01/16/diagnostic-tools-debugger-window-in-visual-studio-2015.aspx>Diagnostic Tools</a> and <strong>Live Visual Tree</strong>. Live Visual Tree shows a hierarchy of WPF elements in the app that you&rsquo;re debugging. It is complimented by <strong>Live Property Explorer</strong> that shows (and lets you change) properties of UI elements at runtime! It gets very interesting if you&rsquo;re debugging Visual Studio itself (e.g. when debugging a Visual Studio extension)</p><hr><p>Live Visual Tree and Live Property Explorer allow you to try out different looks of the UI without restarting the app with every change. Here, I changed the content of a <code>TextBlock</code> in the tab and applied red color to it</p><p><img src=//amadeusw.com/techBlogData//live-visual-tree-vs/mischief1.PNG alt=screenshot></p><p>using Live Property Explorer</p><p><img src=//amadeusw.com/techBlogData//live-visual-tree-vs/property-explorer.PNG alt=screenshot></p><p>Live Visual Tree shows where this TextBlock is located</p><p><img src=//amadeusw.com/techBlogData//live-visual-tree-vs/visual-tree.PNG alt=screenshot></p><hr><h2 id=how-to>How to&mldr;</h2><h1 id=launch>Launch</h1><p><strong>Live Visual Tree</strong> and <strong>Live Property Explorer</strong> are accessible from <strong>Debug > Windows</strong> menu in Visual Studio 2015.</p><h1 id=find-ui-element-in-the-hierarchy>Find UI element in the hierarchy</h1><p>Toggle the first button <em>Enable selection in the running application</em> to select UI elements in your debugged application and bring them to your attention in hierarchy within Live Visual Tree. This overrides mouse click events.</p><p><img src=//amadeusw.com/techBlogData//live-visual-tree-vs/gyazo1.PNG alt=screenshot></p><p><img src=//amadeusw.com/techBlogData//live-visual-tree-vs/gyazo1result.png alt=screenshot></p><h1 id=find-ui-element-visually>Find UI element visually</h1><p>Toggle the second button <em>Display layout adorners in the running application</em> to highlight the UI element which is selected in hierarchy within Live Visual Tree</p><p><img src=//amadeusw.com/techBlogData//live-visual-tree-vs/gyazo2.PNG alt=screenshot></p><p><img src=//amadeusw.com/techBlogData//live-visual-tree-vs/gyazo2result.png alt=screenshot></p><hr><h2 id=possibilities>Possibilities</h2><p>Live Visual Tree came in handy when I needed to see how the VS search box was built. Clicking on the search box revealed it within the UI element hierarchy.</p><p><img src=//amadeusw.com/techBlogData//live-visual-tree-vs/search-box.PNG alt=screenshot></p><h1 id=finding-namespace-and-type-name-of-a-control>Finding namespace and type name of a control</h1><p>In Live Visual Tree I backtracked a bit to find the parent class <code>FindControl</code>. Hovering the mouse over the element&rsquo;s name shows the tooltip with the type&rsquo;s namespace. By convention, I deduced that the code must be located in <code>Microsoft.VisualStudio.Editor.Implementation.dll</code>. Thank you Live Visual Tree for spilling Visual Studio&rsquo;s secrets!</p><p><img src=//amadeusw.com/techBlogData//live-visual-tree-vs/search-box-hierarchy.png alt=screenshot></p><h1 id=investigating-type-and-properties-of-datacontext>Investigating type and properties of DataContext</h1><p>Live Property Explorer also shows the type of the DataContext, which may come in handy if it is set dynamically. In the screenshot below, the type is <code>LaunchControlViewModel</code>. You can expand the DataContext and peek at the properties. You can also change them, and if the property code invoke <code>NotifyPropertyChanged</code> on change, editing properties in Live Property Explorer will trigget the event!</p><p><img src=//amadeusw.com/techBlogData//live-visual-tree-vs/see-type-names.png alt=screenshot></p></article></main><footer><span><a href=about/>//AW</a></span>
<span><a href=#>Scroll to top</a></span></footer></body></html>